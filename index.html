<!DOCTYPE html>
<html>
<head>
  <title>Drag & Drop Canvas OCR</title>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.5/dist/tesseract.min.js"></script>
  <style>
    #canvas {
      width: 400px;
      height: 200px;
      border: 2px dashed #444;
      display: block;
      margin-bottom: 10px;
    }
    #output {
      font-family: monospace;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>

<h3>Drag & Drop an Image here</h3>
<canvas id="canvas" width="400" height="200"></canvas>
<button id="readText">Recognize Text</button>
<p id="output">Text will appear here...</p>

<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const output = document.getElementById('output');

  
  ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
    canvas.addEventListener(eventName, e => e.preventDefault(), false);
  });

  //  dropped files
  canvas.addEventListener('drop', e => {
    const file = e.dataTransfer.files[0];
    if (!file || !file.type.startsWith('image/')) return;

    const img = new Image();
    const reader = new FileReader();

    reader.onload = () => {
      img.onload = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        // Resi
        const scale = Math.min(canvas.width / img.width, canvas.height / img.height);
        const w = img.width * scale;
        const h = img.height * scale;
        const x = (canvas.width - w) / 2;
        const y = (canvas.height - h) / 2;
        ctx.drawImage(img, x, y, w, h);
      };
      img.src = reader.result;
    };

    reader.readAsDataURL(file);
  });

  // processing 
  document.getElementById('readText').addEventListener('click', () => {
    output.textContent = 'Reading...';

    Tesseract.recognize(
      canvas,
      'eng',
      { logger: m => console.log(m) }
    ).then(({ data: { text } }) => {
      output.textContent = text || '[No text detected]';
    });
  });
</script>

</body>
</html>
